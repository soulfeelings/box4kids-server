# Архитектура проекта Box4Kids

## Выбранная архитектура: Простая архитектура (Simple Architecture)

### Обоснование выбора:

- **MVP проект** - нужна быстрая разработка
- **1 разработчик** - не нужна сложность
- **Простые CRUD операции** - базовая функциональность
- **TDD подход** - простая структура лучше для тестирования
- **Нагрузка ~1000 пользователей** - монолит справится

## Структура проекта

```
server/
├── models/          # SQLAlchemy модели (User, Child, Subscription, etc.)
├── services/        # Бизнес-логика и use cases
├── api/            # FastAPI контроллеры и роутеры
├── schemas/        # Pydantic схемы для валидации
├── tests/          # Unit и integration тесты (TDD)
├── core/           # Конфигурация, database, security
└── main.py         # Точка входа FastAPI приложения
```

## Принципы архитектуры

### 1. Разделение ответственности

- **Controllers (api/)** - только HTTP логика, валидация входных данных
- **Services (services/)** - вся бизнес-логика, орекстрация операций
- **Models (models/)** - сущности базы данных
- **Schemas (schemas/)** - контракты API

### 2. Dependency Injection

- Используем FastAPI Depends() для внедрения зависимостей
- Сервисы получают database session через DI
- Моки внешних сервисов для тестирования

### 3. Test-Driven Development (TDD)

- Пишем тесты перед кодом
- Unit тесты для сервисов
- Integration тесты для API endpoints
- Моки для внешних сервисов (SMS, Payment)

## Внешние интеграции

### Запланированные сервисы:

1. **SMS сервис** - отправка OTP кодов (пока мок)
2. **Payment сервис** - обработка платежей (пока мок)

### Подход к мокированию:

- Интерфейсы для внешних сервисов
- Реальная и мок реализация
- Переключение через конфигурацию

## Возможность эволюции

При росте проекта возможен рефакторинг в:

- **Модульный монолит** - при усложнении бизнес-логики
- **Clean Architecture** - при росте команды
- **Микросервисы** - при необходимости масштабирования

## Технологический стек

- **FastAPI** - веб-фреймворк
- **SQLAlchemy** - ORM
- **Pydantic** - валидация данных
- **PostgreSQL** - база данных
- **Redis** - кеширование (опционально)
- **pytest** - тестирование
